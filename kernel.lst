     1                                  %include "pm.mac"
     2                              <1> 
     3                              <1> ; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     4                              <1> ;                               pm.inc
     5                              <1> ; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     6                              <1> ;                                                     Forrest Yu, 2005
     7                              <1> ; ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
     8                              <1> 
     9                              <1> 
    10                              <1> ; æè¿°ç¬¦å›¾ç¤º
    11                              <1> 
    12                              <1> ; å›¾ç¤ºä¸€
    13                              <1> ;
    14                              <1> ;  ------ â”â”â”â”³â”â”â”“é«˜åœ°å€
    15                              <1> ;         â”ƒ 7  â”ƒ æ®µ â”ƒ
    16                              <1> ;         â”£â”â”â”«    â”ƒ
    17                              <1> ;                  åŸº
    18                              <1> ;  å­—èŠ‚ 7 â”†    â”†    â”†
    19                              <1> ;                  å€
    20                              <1> ;         â”£â”â”â”« â‘¡ â”ƒ
    21                              <1> ;         â”ƒ 0  â”ƒ    â”ƒ
    22                              <1> ;  ------ â”£â”â”â•‹â”â”â”«
    23                              <1> ;         â”ƒ 7  â”ƒ G  â”ƒ
    24                              <1> ;         â”£â”â”â•‰â”€â”€â”¨
    25                              <1> ;         â”ƒ 6  â”ƒ D  â”ƒ
    26                              <1> ;         â”£â”â”â•‰â”€â”€â”¨
    27                              <1> ;         â”ƒ 5  â”ƒ 0  â”ƒ
    28                              <1> ;         â”£â”â”â•‰â”€â”€â”¨
    29                              <1> ;         â”ƒ 4  â”ƒ AVLâ”ƒ
    30                              <1> ;  å­—èŠ‚ 6 â”£â”â”â•‰â”€â”€â”¨
    31                              <1> ;         â”ƒ 3  â”ƒ    â”ƒ
    32                              <1> ;         â”£â”â”â”« æ®µ â”ƒ
    33                              <1> ;         â”ƒ 2  â”ƒ ç•Œ â”ƒ
    34                              <1> ;         â”£â”â”â”« é™ â”ƒ
    35                              <1> ;         â”ƒ 1  â”ƒ    â”ƒ
    36                              <1> ;         â”£â”â”â”« â‘¡ â”ƒ
    37                              <1> ;         â”ƒ 0  â”ƒ    â”ƒ
    38                              <1> ;  ------ â”£â”â”â•‹â”â”â”«
    39                              <1> ;         â”ƒ 7  â”ƒ P  â”ƒ
    40                              <1> ;         â”£â”â”â•‰â”€â”€â”¨
    41                              <1> ;         â”ƒ 6  â”ƒ    â”ƒ
    42                              <1> ;         â”£â”â”â”« DPLâ”ƒ
    43                              <1> ;         â”ƒ 5  â”ƒ    â”ƒ
    44                              <1> ;         â”£â”â”â•‰â”€â”€â”¨
    45                              <1> ;         â”ƒ 4  â”ƒ S  â”ƒ
    46                              <1> ;  å­—èŠ‚ 5 â”£â”â”â•‰â”€â”€â”¨
    47                              <1> ;         â”ƒ 3  â”ƒ    â”ƒ
    48                              <1> ;         â”£â”â”â”« T  â”ƒ
    49                              <1> ;         â”ƒ 2  â”ƒ Y  â”ƒ
    50                              <1> ;         â”£â”â”â”« P  â”ƒ
    51                              <1> ;         â”ƒ 1  â”ƒ E  â”ƒ
    52                              <1> ;         â”£â”â”â”«    â”ƒ
    53                              <1> ;         â”ƒ 0  â”ƒ    â”ƒ
    54                              <1> ;  ------ â”£â”â”â•‹â”â”â”«
    55                              <1> ;         â”ƒ 23 â”ƒ    â”ƒ
    56                              <1> ;         â”£â”â”â”«    â”ƒ
    57                              <1> ;         â”ƒ 22 â”ƒ    â”ƒ
    58                              <1> ;         â”£â”â”â”« æ®µ â”ƒ
    59                              <1> ;
    60                              <1> ;   å­—èŠ‚  â”†    â”† åŸº â”†
    61                              <1> ; 2, 3, 4
    62                              <1> ;         â”£â”â”â”« å€ â”ƒ
    63                              <1> ;         â”ƒ 1  â”ƒ â‘  â”ƒ
    64                              <1> ;         â”£â”â”â”«    â”ƒ
    65                              <1> ;         â”ƒ 0  â”ƒ    â”ƒ
    66                              <1> ;  ------ â”£â”â”â•‹â”â”â”«
    67                              <1> ;         â”ƒ 15 â”ƒ    â”ƒ
    68                              <1> ;         â”£â”â”â”«    â”ƒ
    69                              <1> ;         â”ƒ 14 â”ƒ    â”ƒ
    70                              <1> ;         â”£â”â”â”« æ®µ â”ƒ
    71                              <1> ;
    72                              <1> ; å­—èŠ‚ 0,1â”†    â”† ç•Œ â”†
    73                              <1> ;
    74                              <1> ;         â”£â”â”â”« é™ â”ƒ
    75                              <1> ;         â”ƒ 1  â”ƒ â‘  â”ƒ
    76                              <1> ;         â”£â”â”â”«    â”ƒ
    77                              <1> ;         â”ƒ 0  â”ƒ    â”ƒ
    78                              <1> ;  ------ â”—â”â”â”»â”â”â”›ä½åœ°å€
    79                              <1> ;
    80                              <1> 
    81                              <1> 
    82                              <1> ; å›¾ç¤ºäºŒ
    83                              <1> 
    84                              <1> ; é«˜åœ°å€â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦ä½åœ°å€
    85                              <1> 
    86                              <1> ; |   7   |   6   |   5   |   4   |   3   |   2   |   1   |   0    |
    87                              <1> ; |7654321076543210765432107654321076543210765432107654321076543210|	<- å…± 8 å­—èŠ‚
    88                              <1> ; |--------========--------========--------========--------========|
    89                              <1> ; â”â”â”â”â”³â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
    90                              <1> ; â”ƒ31..24â”ƒ   (è§ä¸‹å›¾)   â”ƒ     æ®µåŸºå€(23..0)    â”ƒ æ®µç•Œé™(15..0)â”ƒ
    91                              <1> ; â”ƒ      â”ƒ              â”ƒ                      â”ƒ              â”ƒ
    92                              <1> ; â”ƒ åŸºå€2â”ƒâ‘¢â”‚â‘¡â”‚    â‘ â”ƒåŸºå€1bâ”‚   åŸºå€1a     â”ƒ    æ®µç•Œé™1   â”ƒ
    93                              <1> ; â”£â”â”â”â•‹â”â”â”â”³â”â”â”â•‹â”â”â”â”â”â”â”â”â”â”â”â•‹â”â”â”â”â”â”â”â”«
    94                              <1> ; â”ƒ   %6 â”ƒ  %5  â”ƒ  %4  â”ƒ  %3  â”ƒ     %2       â”ƒ       %1     â”ƒ
    95                              <1> ; â”—â”â”â”â”»â”â”â”â”»â”â”â”â”»â”â”â”â”»â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”›
    96                              <1> ;         â”‚                \_________
    97                              <1> ;         â”‚                          \__________________
    98                              <1> ;         â”‚                                             \________________________________________________
    99                              <1> ;         â”‚                                                                                              ;         â”â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”
   100                              <1> ;         â”ƒ 7  â”ƒ 6  â”ƒ 5  â”ƒ 4  â”ƒ 3  â”ƒ 2  â”ƒ 1  â”ƒ 0  â”ƒ 7  â”ƒ 6  â”ƒ 5  â”ƒ 4  â”ƒ 3  â”ƒ 2  â”ƒ 1  â”ƒ 0  â”ƒ
   101                              <1> ;         â”£â”â”â•‹â”â”â•‹â”â”â•‹â”â”â•‹â”â”â”»â”â”â”»â”â”â”»â”â”â•‹â”â”â•‹â”â”â”»â”â”â•‹â”â”â•‹â”â”â”»â”â”â”»â”â”â”»â”â”â”«
   102                              <1> ;         â”ƒ G  â”ƒ D  â”ƒ 0  â”ƒ AVLâ”ƒ   æ®µç•Œé™ 2 (19..16)  â”ƒ  P â”ƒ   DPL    â”ƒ S  â”ƒ       TYPE           â”ƒ
   103                              <1> ;         â”£â”â”â”»â”â”â”»â”â”â”»â”â”â•‹â”â”â”â”â”â”â”â”â”â”â”â•‹â”â”â”»â”â”â”â”â”â”»â”â”â”»â”â”â”â”â”â”â”â”â”â”â”â”«
   104                              <1> ;         â”ƒ      â‘¢: å±æ€§ 2      â”ƒ    â‘¡: æ®µç•Œé™ 2      â”ƒ                   â‘ : å±æ€§1                  â”ƒ
   105                              <1> ;         â”—â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
   106                              <1> ;       é«˜åœ°å€                                                                                          ä½åœ°å€
   107                              <1> ;
   108                              <1> ;
   109                              <1> 
   110                              <1> ; è¯´æ˜:
   111                              <1> ;
   112                              <1> ; (1) P:    å­˜åœ¨(Present)ä½ã€‚
   113                              <1> ;		P=1 è¡¨ç¤ºæè¿°ç¬¦å¯¹åœ°å€è½¬æ¢æ˜¯æœ‰æ•ˆçš„ï¼Œæˆ–è€…è¯´è¯¥æè¿°ç¬¦æ‰€æè¿°çš„æ®µå­˜åœ¨ï¼Œå³åœ¨å†…å­˜ä¸­ï¼›
   114                              <1> ;		P=0 è¡¨ç¤ºæè¿°ç¬¦å¯¹åœ°å€è½¬æ¢æ— æ•ˆï¼Œå³è¯¥æ®µä¸å­˜åœ¨ã€‚ä½¿ç”¨è¯¥æè¿°ç¬¦è¿›è¡Œå†…å­˜è®¿é—®æ—¶ä¼šå¼•èµ·å¼‚å¸¸ã€‚
   115                              <1> ;
   116                              <1> ; (2) DPL:  è¡¨ç¤ºæè¿°ç¬¦ç‰¹æƒçº§(Descriptor Privilege level)ï¼Œå…±2ä½ã€‚å®ƒè§„å®šäº†æ‰€æè¿°æ®µçš„ç‰¹æƒçº§ï¼Œç”¨äºç‰¹æƒæ£€æŸ¥ï¼Œä»¥å†³å®šå¯¹è¯¥æ®µèƒ½å¦è®¿é—®ã€‚ 
   117                              <1> ;
   118                              <1> ; (3) S:   è¯´æ˜æè¿°ç¬¦çš„ç±»å‹ã€‚
   119                              <1> ;		å¯¹äºå­˜å‚¨æ®µæè¿°ç¬¦è€Œè¨€ï¼ŒS=1ï¼Œä»¥åŒºåˆ«ä¸ç³»ç»Ÿæ®µæè¿°ç¬¦å’Œé—¨æè¿°ç¬¦(S=0)ã€‚ 
   120                              <1> ;
   121                              <1> ; (4) TYPE: è¯´æ˜å­˜å‚¨æ®µæè¿°ç¬¦æ‰€æè¿°çš„å­˜å‚¨æ®µçš„å…·ä½“å±æ€§ã€‚
   122                              <1> ;
   123                              <1> ;		 
   124                              <1> ;	æ•°æ®æ®µç±»å‹	ç±»å‹å€¼		è¯´æ˜
   125                              <1> ;			----------------------------------
   126                              <1> ;			0		åªè¯» 
   127                              <1> ;			1		åªè¯»ã€å·²è®¿é—® 
   128                              <1> ;			2		è¯»/å†™ 
   129                              <1> ;			3		è¯»/å†™ã€å·²è®¿é—® 
   130                              <1> ;			4		åªè¯»ã€å‘ä¸‹æ‰©å±• 
   131                              <1> ;			5		åªè¯»ã€å‘ä¸‹æ‰©å±•ã€å·²è®¿é—® 
   132                              <1> ;			6		è¯»/å†™ã€å‘ä¸‹æ‰©å±• 
   133                              <1> ;			7		è¯»/å†™ã€å‘ä¸‹æ‰©å±•ã€å·²è®¿é—® 
   134                              <1> ;
   135                              <1> ;		
   136                              <1> ;			ç±»å‹å€¼		è¯´æ˜
   137                              <1> ;	ä»£ç æ®µç±»å‹	----------------------------------
   138                              <1> ;			8		åªæ‰§è¡Œ 
   139                              <1> ;			9		åªæ‰§è¡Œã€å·²è®¿é—® 
   140                              <1> ;			A		æ‰§è¡Œ/è¯» 
   141                              <1> ;			B		æ‰§è¡Œ/è¯»ã€å·²è®¿é—® 
   142                              <1> ;			C		åªæ‰§è¡Œã€ä¸€è‡´ç æ®µ 
   143                              <1> ;			D		åªæ‰§è¡Œã€ä¸€è‡´ç æ®µã€å·²è®¿é—® 
   144                              <1> ;			E		æ‰§è¡Œ/è¯»ã€ä¸€è‡´ç æ®µ 
   145                              <1> ;			F		æ‰§è¡Œ/è¯»ã€ä¸€è‡´ç æ®µã€å·²è®¿é—® 
   146                              <1> ;
   147                              <1> ;		
   148                              <1> ;	ç³»ç»Ÿæ®µç±»å‹	ç±»å‹ç¼–ç 	è¯´æ˜
   149                              <1> ;			----------------------------------
   150                              <1> ;			0		<æœªå®šä¹‰>
   151                              <1> ;			1		å¯ç”¨286TSS
   152                              <1> ;			2		LDT
   153                              <1> ;			3		å¿™çš„286TSS
   154                              <1> ;			4		286è°ƒç”¨é—¨
   155                              <1> ;			5		ä»»åŠ¡é—¨
   156                              <1> ;			6		286ä¸­æ–­é—¨
   157                              <1> ;			7		286é™·é˜±é—¨
   158                              <1> ;			8		æœªå®šä¹‰
   159                              <1> ;			9		å¯ç”¨386TSS
   160                              <1> ;			A		<æœªå®šä¹‰>
   161                              <1> ;			B		å¿™çš„386TSS
   162                              <1> ;			C		386è°ƒç”¨é—¨
   163                              <1> ;			D		<æœªå®šä¹‰>
   164                              <1> ;			E		386ä¸­æ–­é—¨
   165                              <1> ;			F		386é™·é˜±é—¨
   166                              <1> ;
   167                              <1> ; (5) G:    æ®µç•Œé™ç²’åº¦(Granularity)ä½ã€‚
   168                              <1> ;		G=0 è¡¨ç¤ºç•Œé™ç²’åº¦ä¸ºå­—èŠ‚ï¼›
   169                              <1> ;		G=1 è¡¨ç¤ºç•Œé™ç²’åº¦ä¸º4K å­—èŠ‚ã€‚
   170                              <1> ;           æ³¨æ„ï¼Œç•Œé™ç²’åº¦åªå¯¹æ®µç•Œé™æœ‰æ•ˆï¼Œå¯¹æ®µåŸºåœ°å€æ— æ•ˆï¼Œæ®µåŸºåœ°å€æ€»æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½ã€‚ 
   171                              <1> ;
   172                              <1> ; (6) D:    Dä½æ˜¯ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„ä½ï¼Œåœ¨æè¿°å¯æ‰§è¡Œæ®µã€å‘ä¸‹æ‰©å±•æ•°æ®æ®µæˆ–ç”±SSå¯„å­˜å™¨å¯»å€çš„æ®µ(é€šå¸¸æ˜¯å †æ ˆæ®µ)çš„ä¸‰ç§æè¿°ç¬¦ä¸­çš„æ„ä¹‰å„ä¸ç›¸åŒã€‚ 
   173                              <1> ;           â‘´ åœ¨æè¿°å¯æ‰§è¡Œæ®µçš„æè¿°ç¬¦ä¸­ï¼ŒDä½å†³å®šäº†æŒ‡ä»¤ä½¿ç”¨çš„åœ°å€åŠæ“ä½œæ•°æ‰€é»˜è®¤çš„å¤§å°ã€‚
   174                              <1> ;		â‘  D=1è¡¨ç¤ºé»˜è®¤æƒ…å†µä¸‹æŒ‡ä»¤ä½¿ç”¨32ä½åœ°å€åŠ32ä½æˆ–8ä½æ“ä½œæ•°ï¼Œè¿™æ ·çš„ä»£ç æ®µä¹Ÿç§°ä¸º32ä½ä»£ç æ®µï¼›
   175                              <1> ;		â‘¡ D=0 è¡¨ç¤ºé»˜è®¤æƒ…å†µä¸‹ï¼Œä½¿ç”¨16ä½åœ°å€åŠ16ä½æˆ–8ä½æ“ä½œæ•°ï¼Œè¿™æ ·çš„ä»£ç æ®µä¹Ÿç§°ä¸º16ä½ä»£ç æ®µï¼Œå®ƒä¸80286å…¼å®¹ã€‚å¯ä»¥ä½¿ç”¨åœ°å€å¤§å°å‰ç¼€å’Œæ“ä½œæ•°å¤§å°å‰ç¼€åˆ†åˆ«æ”¹å˜é»˜è®¤
   176                              <1> ;           â‘µ åœ¨å‘ä¸‹æ‰©å±•æ•°æ®æ®µçš„æè¿°ç¬¦ä¸­ï¼ŒDä½å†³å®šæ®µçš„ä¸Šéƒ¨è¾¹ç•Œã€‚
   177                              <1> ;		â‘  D=1è¡¨ç¤ºæ®µçš„ä¸Šéƒ¨ç•Œé™ä¸º4Gï¼›
   178                              <1> ;		â‘¡ D=0è¡¨ç¤ºæ®µçš„ä¸Šéƒ¨ç•Œé™ä¸º64Kï¼Œè¿™æ˜¯ä¸ºäº†ä¸80286å…¼å®¹ã€‚ 
   179                              <1> ;           â‘¶ åœ¨æè¿°ç”±SSå¯„å­˜å™¨å¯»å€çš„æ®µæè¿°ç¬¦ä¸­ï¼ŒDä½å†³å®šéšå¼çš„å †æ ˆè®¿é—®æŒ‡ä»¤(å¦‚PUSHå’ŒPOPæŒ‡ä»¤)ä½¿ç”¨ä½•ç§å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨ã€‚
   180                              <1> ;		â‘  D=1è¡¨ç¤ºä½¿ç”¨32ä½å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨ESPï¼›
   181                              <1> ;		â‘¡ D=0è¡¨ç¤ºä½¿ç”¨16ä½å †æ ˆæŒ‡é’ˆå¯„å­˜å™¨SPï¼Œè¿™ä¸80286å…¼å®¹ã€‚ 
   182                              <1> ;
   183                              <1> ; (7) AVL:  è½¯ä»¶å¯åˆ©ç”¨ä½ã€‚80386å¯¹è¯¥ä½çš„ä½¿ç”¨æœªå·¦è§„å®šï¼ŒIntelå…¬å¸ä¹Ÿä¿è¯ä»Šåå¼€å‘ç”Ÿäº§çš„å¤„ç†å™¨åªè¦ä¸80386å…¼å®¹ï¼Œå°±ä¸ä¼šå¯¹è¯¥ä½çš„ä½¿ç”¨åšä»»ä½•å®šä¹‰æˆ–è§„å®šã€‚ 
   184                              <1> ;
   185                              <1> 
   186                              <1> 
   187                              <1> ;----------------------------------------------------------------------------
   188                              <1> ; æè¿°ç¬¦ç±»å‹å€¼è¯´æ˜
   189                              <1> ; å…¶ä¸­:
   190                              <1> ;       DA_  : Descriptor Attribute
   191                              <1> ;       D    : æ•°æ®æ®µ
   192                              <1> ;       C    : ä»£ç æ®µ
   193                              <1> ;       S    : ç³»ç»Ÿæ®µ
   194                              <1> ;       R    : åªè¯»
   195                              <1> ;       RW   : è¯»å†™
   196                              <1> ;       A    : å·²è®¿é—®
   197                              <1> ;       å…¶å®ƒ : å¯æŒ‰ç…§å­—é¢æ„æ€ç†è§£
   198                              <1> ;----------------------------------------------------------------------------
   199                              <1> DA_32		EQU	4000h	; 32 ä½æ®µ
   200                              <1> DA_LIMIT_4K	EQU	8000h	; æ®µç•Œé™ç²’åº¦ä¸º 4K å­—èŠ‚
   201                              <1> 
   202                              <1> DA_DPL0		EQU	  00h	; DPL = 0
   203                              <1> DA_DPL1		EQU	  20h	; DPL = 1
   204                              <1> DA_DPL2		EQU	  40h	; DPL = 2
   205                              <1> DA_DPL3		EQU	  60h	; DPL = 3
   206                              <1> ;----------------------------------------------------------------------------
   207                              <1> ; å­˜å‚¨æ®µæè¿°ç¬¦ç±»å‹å€¼è¯´æ˜
   208                              <1> ;----------------------------------------------------------------------------
   209                              <1> DA_DR		EQU	90h	; å­˜åœ¨çš„åªè¯»æ•°æ®æ®µç±»å‹å€¼
   210                              <1> DA_DRW		EQU	92h	; å­˜åœ¨çš„å¯è¯»å†™æ•°æ®æ®µå±æ€§å€¼
   211                              <1> DA_DRWA		EQU	93h	; å­˜åœ¨çš„å·²è®¿é—®å¯è¯»å†™æ•°æ®æ®µç±»å‹å€¼
   212                              <1> DA_C		EQU	98h	; å­˜åœ¨çš„åªæ‰§è¡Œä»£ç æ®µå±æ€§å€¼
   213                              <1> DA_CR		EQU	9Ah	; å­˜åœ¨çš„å¯æ‰§è¡Œå¯è¯»ä»£ç æ®µå±æ€§å€¼
   214                              <1> DA_CCO		EQU	9Ch	; å­˜åœ¨çš„åªæ‰§è¡Œä¸€è‡´ä»£ç æ®µå±æ€§å€¼
   215                              <1> DA_CCOR		EQU	9Eh	; å­˜åœ¨çš„å¯æ‰§è¡Œå¯è¯»ä¸€è‡´ä»£ç æ®µå±æ€§å€¼
   216                              <1> ;----------------------------------------------------------------------------
   217                              <1> ; ç³»ç»Ÿæ®µæè¿°ç¬¦ç±»å‹å€¼è¯´æ˜
   218                              <1> ;----------------------------------------------------------------------------
   219                              <1> DA_LDT		EQU	  82h	; å±€éƒ¨æè¿°ç¬¦è¡¨æ®µç±»å‹å€¼
   220                              <1> DA_TaskGate	EQU	  85h	; ä»»åŠ¡é—¨ç±»å‹å€¼
   221                              <1> DA_386TSS	EQU	  89h	; å¯ç”¨ 386 ä»»åŠ¡çŠ¶æ€æ®µç±»å‹å€¼
   222                              <1> DA_386CGate	EQU	  8Ch	; 386 è°ƒç”¨é—¨ç±»å‹å€¼
   223                              <1> DA_386IGate	EQU	  8Eh	; 386 ä¸­æ–­é—¨ç±»å‹å€¼
   224                              <1> DA_386TGate	EQU	  8Fh	; 386 é™·é˜±é—¨ç±»å‹å€¼
   225                              <1> ;----------------------------------------------------------------------------
   226                              <1> 
   227                              <1> 
   228                              <1> ; é€‰æ‹©å­å›¾ç¤º:
   229                              <1> ;         â”â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”³â”â”â”“
   230                              <1> ;         â”ƒ 15 â”ƒ 14 â”ƒ 13 â”ƒ 12 â”ƒ 11 â”ƒ 10 â”ƒ 9  â”ƒ 8  â”ƒ 7  â”ƒ 6  â”ƒ 5  â”ƒ 4  â”ƒ 3  â”ƒ 2  â”ƒ 1  â”ƒ 0  â”ƒ
   231                              <1> ;         â”£â”â”â”»â”â”â”»â”â”â”»â”â”â”»â”â”â”»â”â”â”»â”â”â”»â”â”â”»â”â”â”»â”â”â”»â”â”â”»â”â”â”»â”â”â•‹â”â”â•‹â”â”â”»â”â”â”«
   232                              <1> ;         â”ƒ                                 æè¿°ç¬¦ç´¢å¼•                                 â”ƒ TI â”ƒ   RPL    â”ƒ
   233                              <1> ;         â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”»â”â”â”»â”â”â”â”â”â”›
   234                              <1> ;
   235                              <1> ; RPL(Requested Privilege Level): è¯·æ±‚ç‰¹æƒçº§ï¼Œç”¨äºç‰¹æƒæ£€æŸ¥ã€‚
   236                              <1> ;
   237                              <1> ; TI(Table Indicator): å¼•ç”¨æè¿°ç¬¦è¡¨æŒ‡ç¤ºä½
   238                              <1> ;	TI=0 æŒ‡ç¤ºä»å…¨å±€æè¿°ç¬¦è¡¨GDTä¸­è¯»å–æè¿°ç¬¦ï¼›
   239                              <1> ;	TI=1 æŒ‡ç¤ºä»å±€éƒ¨æè¿°ç¬¦è¡¨LDTä¸­è¯»å–æè¿°ç¬¦ã€‚
   240                              <1> ;
   241                              <1> 
   242                              <1> ;----------------------------------------------------------------------------
   243                              <1> ; é€‰æ‹©å­ç±»å‹å€¼è¯´æ˜
   244                              <1> ; å…¶ä¸­:
   245                              <1> ;       SA_  : Selector Attribute
   246                              <1> 
   247                              <1> SA_RPL0		EQU	0	; â”“
   248                              <1> SA_RPL1		EQU	1	; â”£ RPL
   249                              <1> SA_RPL2		EQU	2	; â”ƒ
   250                              <1> SA_RPL3		EQU	3	; â”›
   251                              <1> 
   252                              <1> SA_TIG		EQU	0	; â”“TI
   253                              <1> SA_TIL		EQU	4	; â”›
   254                              <1> ;----------------------------------------------------------------------------
   255                              <1> 
   256                              <1> 
   257                              <1> ;----------------------------------------------------------------------------
   258                              <1> ; åˆ†é¡µæœºåˆ¶ä½¿ç”¨çš„å¸¸é‡è¯´æ˜
   259                              <1> ;----------------------------------------------------------------------------
   260                              <1> PG_P		EQU	1	; é¡µå­˜åœ¨å±æ€§ä½
   261                              <1> PG_RWR		EQU	0	; R/W å±æ€§ä½å€¼, è¯»/æ‰§è¡Œ
   262                              <1> PG_RWW		EQU	2	; R/W å±æ€§ä½å€¼, è¯»/å†™/æ‰§è¡Œ
   263                              <1> PG_USS		EQU	0	; U/S å±æ€§ä½å€¼, ç³»ç»Ÿçº§
   264                              <1> PG_USU		EQU	4	; U/S å±æ€§ä½å€¼, ç”¨æˆ·çº§
   265                              <1> ;----------------------------------------------------------------------------
   266                              <1> 
   267                              <1> 
   268                              <1> 
   269                              <1> 
   270                              <1> ; =========================================
   271                              <1> ; FLAGS - Intel 8086 Family Flags Register
   272                              <1> ; =========================================
   273                              <1> ;
   274                              <1> ;      |11|10|F|E|D|C|B|A|9|8|7|6|5|4|3|2|1|0|
   275                              <1> ;        |  | | | | | | | | | | | | | | | | '---  CFâ€¦â€¦Carry Flag
   276                              <1> ;        |  | | | | | | | | | | | | | | | '---  1
   277                              <1> ;        |  | | | | | | | | | | | | | | '---  PFâ€¦â€¦Parity Flag
   278                              <1> ;        |  | | | | | | | | | | | | | '---  0
   279                              <1> ;        |  | | | | | | | | | | | | '---  AFâ€¦â€¦Auxiliary Flag
   280                              <1> ;        |  | | | | | | | | | | | '---  0
   281                              <1> ;        |  | | | | | | | | | | '---  ZFâ€¦â€¦Zero Flag
   282                              <1> ;        |  | | | | | | | | | '---  SFâ€¦â€¦Sign Flag
   283                              <1> ;        |  | | | | | | | | '---  TFâ€¦â€¦Trap Flag  (Single Step)
   284                              <1> ;        |  | | | | | | | '---  IFâ€¦â€¦Interrupt Flag
   285                              <1> ;        |  | | | | | | '---  DFâ€¦â€¦Direction Flag
   286                              <1> ;        |  | | | | | '---  OFâ€¦â€¦Overflow flag
   287                              <1> ;        |  | | | '-----  IOPLâ€¦â€¦I/O Privilege Level  (286+ only)
   288                              <1> ;        |  | | '-----  NTâ€¦â€¦Nested Task Flag  (286+ only)
   289                              <1> ;        |  | '-----  0
   290                              <1> ;        |  '-----  RFâ€¦â€¦Resume Flag (386+ only)
   291                              <1> ;        '------  VMâ€¦â€¦Virtual Mode Flag (386+ only)
   292                              <1> ;
   293                              <1> ;        æ³¨: see   PUSHF  POPF  STI  CLI  STD  CLD
   294                              <1> ;
   295                              <1> 
   296                              <1> 
   297                              <1> ; å® ------------------------------------------------------------------------------------------------------
   298                              <1> ;
   299                              <1> ; æè¿°ç¬¦
   300                              <1> ; usage: Descriptor Base, Limit, Attr
   301                              <1> ;        Base:  dd
   302                              <1> ;        Limit: dd (low 20 bits available)
   303                              <1> ;        Attr:  dw (lower 4 bits of higher byte are always 0)
   304                              <1> %macro Descriptor 3
   305                              <1> 	dw	%2 & 0FFFFh				             ; æ®µç•Œé™ 1				(2 å­—èŠ‚)
   306                              <1> 	dw	%1 & 0FFFFh				             ; æ®µåŸºå€ 1				(2 å­—èŠ‚)
   307                              <1> 	db	(%1 >> 16) & 0FFh			         ; æ®µåŸºå€ 2				(1 å­—èŠ‚)
   308                              <1> 	dw	((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)	 ; å±æ€§ 1 + æ®µç•Œé™ 2 + å±æ€§ 2		(2 å­—èŠ‚)
   309                              <1> 	db	(%1 >> 24) & 0FFh			         ; æ®µåŸºå€ 3				(1 å­—èŠ‚)
   310                              <1> %endmacro ; å…± 8 å­—èŠ‚
   311                              <1> ;
   312                              <1> ; é—¨
   313                              <1> ; usage: Gate Selector, Offset, DCount, Attr
   314                              <1> ;        Selector:  dw
   315                              <1> ;        Offset:    dd
   316                              <1> ;        DCount:    db
   317                              <1> ;        Attr:      db
   318                              <1> %macro Gate 4
   319                              <1> 	dw	(%2 & 0FFFFh)				             ; åç§» 1				(2 å­—èŠ‚)
   320                              <1> 	dw	%1					                     ; é€‰æ‹©å­				(2 å­—èŠ‚)
   321                              <1> 	dw	(%3 & 1Fh) | ((%4 << 8) & 0FF00h)	     ; å±æ€§					(2 å­—èŠ‚)
   322                              <1> 	dw	((%2 >> 16) & 0FFFFh)			         ; åç§» 2				(2 å­—èŠ‚)
   323                              <1> %endmacro ; å…± 8 å­—èŠ‚
   324                              <1> ; ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   325                                  
   326                                  %define INIT_ADDR 0x7E00
   327                                  
   328                                  %define COLOR_GREEN 0x02 ;  Green
   329                                  %define COLOR_Cyan  0x03 ;  Cyan
   330                                  %define COLOR_RED   0x04 ;  red
   331                                  %define COLOR_White 0x0F ;  White
   332                                  
   333                                  %define ROWS 80
   334                                  %define ROWZ 2*ROWS
   335                                  %define COLUMNS 25
   336                                  
   337                                  
   338                                  [BITS 32]
   339                                  
   340                                  [SECTION .text]
   341                                      extern c_start             ;out
   342                                      extern print_a
   343                                      extern print_string_with_color  ;  void print_string_with_color(unsigned char * string, unsigned char color);
   344                                      extern init8259a
   345                                      extern   start_clock
   346                                      extern restart_clock
   347                                      extern start_multitasks
   348                                      extern task0
   349                                      extern task0_address
   350                                  
   351                                      global kernel_entry     ;entry
   352                                      global display_x    ;define vari
   353                                      global display_y    ;define vari
   354                                  
   355                                      kernel_entry:
   356                                          ;register initia
   357 00000000 B810000000                      mov eax,  0x10   
   358 00000005 8ED8                            mov ds,   ax     
   359 00000007 8EC0                            mov es,   ax    
   360 00000009 8EE0                            mov fs ,  ax 
   361 0000000B 8ED0                            mov ss,   ax    
   362 0000000D B818000000                      mov eax,  0x18  
   363 00000012 8EE8                            mov gs,   ax       
   364 00000014 BC00000A00                      mov esp,  0xA0000   
   365                                  
   366                                      reload_gdt:
   367 00000019 0F0115[9D050000]                lgdt  [GdtPtr]
   368 00000020 EA[27000000]0800                jmp SelectorFlatC:haha
   369                                      haha:
   370                                          ;call print_a
   371                                  
   372                                  ;        void print_string_with_color(unsigned char * string, unsigned char color);
   373                                          ;push COLOR_RED
   374                                          ;push string1
   375                                          ;call print_string_with_color
   376                                          ;add esp, 0x08
   377                                  
   378                                      init_idt:
   379                                          ;prepare for load idt pointer
   380                                          ;xor eax,eax
   381                                          ;mov ax,ds
   382                                          ;shl eax,4
   383                                          ;add eax,idt;idt base address
   384                                          ;mov dword [idtPtr+2],eax;init base address
   385                                          ;close interrupt
   386                                  
   387                                          ;load idt pointer
   388 00000027 0F011D[08050000]                lidt [idtPtr]
   389                                      ;init idt OKkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
   390                                  
   391 0000002E E8(00000000)                    call init8259a
   392 00000033 FB                              sti
   393 00000034 E8(00000000)                    call start_clock
   394                                          ;int 0x20;clock
   395                                          ;int 0x80;user
   396                                          ;int 0x1f;all
   397                                          ;int 0x00;test 0
   398                                  
   399                                          ;call c_start
   400                                  ;processsssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss
   401                                      ; Load LDT
   402 00000039 66B83000                        mov ax, SelectorLDT
   403 0000003D 0F00D0                          lldt    ax
   404 00000040 66B82000                        mov ax, SelectorTSS
   405 00000044 0F00D8                          ltr ax
   406                                      ;call start_process
   407                                          ;jmp SelectorTSS1:0
   408                                          ;jmp SelectorLDTP0:TASK0ADDRESS
   409                                          ;push    SelectorStack3
   410                                          ;push    TopOfStack3
   411                                          ;push    SelectorCodeRing3
   412                                          ;push    0
   413                                          ;retf
   414                                  
   415                                  ;processsssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss
   416 00000047 F4                              hlt
   417                                      here:		
   418 00000048 EBFE                            jmp here
   419                                  
   420 0000004A 00000000                    display_x: dd 0
   421 0000004E 00000000                    display_y: dd 0
   422                                  
   423 00000052 616C6C20696E746572-         string0: db "all interrupts handler!",0x0a,0x00
   424 0000005B 72757074732068616E-
   425 00000064 646C6572210A00     
   426 0000006B 636C6F636B20696E74-         string1: db "clock interrupt!",0x0a,0x00
   427 00000074 657272757074210A00 
   428 0000007D 6E6F7720697320696E-         string2: db "now is in normal",0x0a,0x00
   429 00000086 206E6F726D616C0A00 
   430 0000008F 6E6F77206973207573-         string3: db "now is user interrupt",0x0a,0x00
   431 00000098 657220696E74657272-
   432 000000A1 7570740A00         
   433 000000A6 5441534B3030303030-         string4: db "TASK00000000000000",0x0a,0x00
   434 000000AF 303030303030303030-
   435 000000B8 0A00               
   436 000000BA 696474203020746573-         string5: db "idt 0 test0Handler!!",0x0a,0x00
   437 000000C3 743048616E646C6572-
   438 000000CC 21210A00           
   439 000000D0 6A6D702053656C6563-         string6: db "jmp SelectorTSS:0 but jmp to int20h!",0x0a,0x00
   440 000000D9 746F725453533A3020-
   441 000000E2 627574206A6D702074-
   442 000000EB 6F20696E7432306821-
   443 000000F4 0A00               
   444                                      ;string1_addr equ string1-$$+INIT_ADDR
   445                                  
   446                                  ; idt gate
   447                                  ;iiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii
   448 000000F6 90<rept>                ALIGN 32
   449                                      idt:
   450                                          ;é—¨    ç›®æ ‡é€‰æ‹©å­ åç§»        DCount   å±æ€§
   451                                    int00h:Gate   0x08,      test0Handler, 0,       DA_386IGate
   452                              <1>  int00h:
   453 00000100 4583                <1>  dw (%2 & 0FFFFh)
   454 00000102 0800                <1>  dw %1
   455 00000104 008E                <1>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   456 00000106 0000                <1>  dw ((%2 >> 16) & 0FFFFh)
   457                                      %rep 30;   60h=0x40
   458                                          Gate   0x08,      test1Handler, 0,       DA_386IGate
   459                                      %endrep
   460                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   461 00000108 5583                <2>  dw (%2 & 0FFFFh)
   462 0000010A 0800                <2>  dw %1
   463 0000010C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   464 0000010E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   465                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   466 00000110 5583                <2>  dw (%2 & 0FFFFh)
   467 00000112 0800                <2>  dw %1
   468 00000114 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   469 00000116 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   470                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   471 00000118 5583                <2>  dw (%2 & 0FFFFh)
   472 0000011A 0800                <2>  dw %1
   473 0000011C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   474 0000011E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   475                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   476 00000120 5583                <2>  dw (%2 & 0FFFFh)
   477 00000122 0800                <2>  dw %1
   478 00000124 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   479 00000126 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   480                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   481 00000128 5583                <2>  dw (%2 & 0FFFFh)
   482 0000012A 0800                <2>  dw %1
   483 0000012C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   484 0000012E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   485                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   486 00000130 5583                <2>  dw (%2 & 0FFFFh)
   487 00000132 0800                <2>  dw %1
   488 00000134 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   489 00000136 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   490                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   491 00000138 5583                <2>  dw (%2 & 0FFFFh)
   492 0000013A 0800                <2>  dw %1
   493 0000013C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   494 0000013E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   495                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   496 00000140 5583                <2>  dw (%2 & 0FFFFh)
   497 00000142 0800                <2>  dw %1
   498 00000144 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   499 00000146 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   500                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   501 00000148 5583                <2>  dw (%2 & 0FFFFh)
   502 0000014A 0800                <2>  dw %1
   503 0000014C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   504 0000014E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   505                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   506 00000150 5583                <2>  dw (%2 & 0FFFFh)
   507 00000152 0800                <2>  dw %1
   508 00000154 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   509 00000156 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   510                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   511 00000158 5583                <2>  dw (%2 & 0FFFFh)
   512 0000015A 0800                <2>  dw %1
   513 0000015C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   514 0000015E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   515                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   516 00000160 5583                <2>  dw (%2 & 0FFFFh)
   517 00000162 0800                <2>  dw %1
   518 00000164 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   519 00000166 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   520                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   521 00000168 5583                <2>  dw (%2 & 0FFFFh)
   522 0000016A 0800                <2>  dw %1
   523 0000016C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   524 0000016E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   525                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   526 00000170 5583                <2>  dw (%2 & 0FFFFh)
   527 00000172 0800                <2>  dw %1
   528 00000174 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   529 00000176 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   530                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   531 00000178 5583                <2>  dw (%2 & 0FFFFh)
   532 0000017A 0800                <2>  dw %1
   533 0000017C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   534 0000017E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   535                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   536 00000180 5583                <2>  dw (%2 & 0FFFFh)
   537 00000182 0800                <2>  dw %1
   538 00000184 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   539 00000186 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   540                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   541 00000188 5583                <2>  dw (%2 & 0FFFFh)
   542 0000018A 0800                <2>  dw %1
   543 0000018C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   544 0000018E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   545                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   546 00000190 5583                <2>  dw (%2 & 0FFFFh)
   547 00000192 0800                <2>  dw %1
   548 00000194 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   549 00000196 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   550                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   551 00000198 5583                <2>  dw (%2 & 0FFFFh)
   552 0000019A 0800                <2>  dw %1
   553 0000019C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   554 0000019E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   555                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   556 000001A0 5583                <2>  dw (%2 & 0FFFFh)
   557 000001A2 0800                <2>  dw %1
   558 000001A4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   559 000001A6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   560                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   561 000001A8 5583                <2>  dw (%2 & 0FFFFh)
   562 000001AA 0800                <2>  dw %1
   563 000001AC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   564 000001AE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   565                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   566 000001B0 5583                <2>  dw (%2 & 0FFFFh)
   567 000001B2 0800                <2>  dw %1
   568 000001B4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   569 000001B6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   570                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   571 000001B8 5583                <2>  dw (%2 & 0FFFFh)
   572 000001BA 0800                <2>  dw %1
   573 000001BC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   574 000001BE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   575                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   576 000001C0 5583                <2>  dw (%2 & 0FFFFh)
   577 000001C2 0800                <2>  dw %1
   578 000001C4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   579 000001C6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   580                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   581 000001C8 5583                <2>  dw (%2 & 0FFFFh)
   582 000001CA 0800                <2>  dw %1
   583 000001CC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   584 000001CE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   585                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   586 000001D0 5583                <2>  dw (%2 & 0FFFFh)
   587 000001D2 0800                <2>  dw %1
   588 000001D4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   589 000001D6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   590                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   591 000001D8 5583                <2>  dw (%2 & 0FFFFh)
   592 000001DA 0800                <2>  dw %1
   593 000001DC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   594 000001DE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   595                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   596 000001E0 5583                <2>  dw (%2 & 0FFFFh)
   597 000001E2 0800                <2>  dw %1
   598 000001E4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   599 000001E6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   600                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   601 000001E8 5583                <2>  dw (%2 & 0FFFFh)
   602 000001EA 0800                <2>  dw %1
   603 000001EC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   604 000001EE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   605                              <1>  Gate 0x08, test1Handler, 0, DA_386IGate
   606 000001F0 5583                <2>  dw (%2 & 0FFFFh)
   607 000001F2 0800                <2>  dw %1
   608 000001F4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   609 000001F6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   610                                   int1fh:Gate   0x08,      test1Handler, 0,       DA_386IGate
   611                              <1>  int1fh:
   612 000001F8 5583                <1>  dw (%2 & 0FFFFh)
   613 000001FA 0800                <1>  dw %1
   614 000001FC 008E                <1>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   615 000001FE 0000                <1>  dw ((%2 >> 16) & 0FFFFh)
   616                                   int20h:Gate   0x08,      clockHandler, 0,       DA_386IGate
   617                              <1>  int20h:
   618 00000200 1E83                <1>  dw (%2 & 0FFFFh)
   619 00000202 0800                <1>  dw %1
   620 00000204 008E                <1>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   621 00000206 0000                <1>  dw ((%2 >> 16) & 0FFFFh)
   622                                      %rep 95; =0x60-1
   623                                         Gate   0x08,      idtHandler, 0,       DA_386IGate
   624                                      %endrep
   625                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   626 00000208 0E83                <2>  dw (%2 & 0FFFFh)
   627 0000020A 0800                <2>  dw %1
   628 0000020C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   629 0000020E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   630                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   631 00000210 0E83                <2>  dw (%2 & 0FFFFh)
   632 00000212 0800                <2>  dw %1
   633 00000214 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   634 00000216 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   635                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   636 00000218 0E83                <2>  dw (%2 & 0FFFFh)
   637 0000021A 0800                <2>  dw %1
   638 0000021C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   639 0000021E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   640                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   641 00000220 0E83                <2>  dw (%2 & 0FFFFh)
   642 00000222 0800                <2>  dw %1
   643 00000224 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   644 00000226 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   645                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   646 00000228 0E83                <2>  dw (%2 & 0FFFFh)
   647 0000022A 0800                <2>  dw %1
   648 0000022C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   649 0000022E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   650                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   651 00000230 0E83                <2>  dw (%2 & 0FFFFh)
   652 00000232 0800                <2>  dw %1
   653 00000234 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   654 00000236 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   655                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   656 00000238 0E83                <2>  dw (%2 & 0FFFFh)
   657 0000023A 0800                <2>  dw %1
   658 0000023C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   659 0000023E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   660                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   661 00000240 0E83                <2>  dw (%2 & 0FFFFh)
   662 00000242 0800                <2>  dw %1
   663 00000244 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   664 00000246 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   665                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   666 00000248 0E83                <2>  dw (%2 & 0FFFFh)
   667 0000024A 0800                <2>  dw %1
   668 0000024C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   669 0000024E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   670                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   671 00000250 0E83                <2>  dw (%2 & 0FFFFh)
   672 00000252 0800                <2>  dw %1
   673 00000254 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   674 00000256 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   675                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   676 00000258 0E83                <2>  dw (%2 & 0FFFFh)
   677 0000025A 0800                <2>  dw %1
   678 0000025C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   679 0000025E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   680                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   681 00000260 0E83                <2>  dw (%2 & 0FFFFh)
   682 00000262 0800                <2>  dw %1
   683 00000264 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   684 00000266 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   685                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   686 00000268 0E83                <2>  dw (%2 & 0FFFFh)
   687 0000026A 0800                <2>  dw %1
   688 0000026C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   689 0000026E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   690                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   691 00000270 0E83                <2>  dw (%2 & 0FFFFh)
   692 00000272 0800                <2>  dw %1
   693 00000274 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   694 00000276 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   695                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   696 00000278 0E83                <2>  dw (%2 & 0FFFFh)
   697 0000027A 0800                <2>  dw %1
   698 0000027C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   699 0000027E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   700                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   701 00000280 0E83                <2>  dw (%2 & 0FFFFh)
   702 00000282 0800                <2>  dw %1
   703 00000284 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   704 00000286 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   705                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   706 00000288 0E83                <2>  dw (%2 & 0FFFFh)
   707 0000028A 0800                <2>  dw %1
   708 0000028C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   709 0000028E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   710                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   711 00000290 0E83                <2>  dw (%2 & 0FFFFh)
   712 00000292 0800                <2>  dw %1
   713 00000294 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   714 00000296 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   715                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   716 00000298 0E83                <2>  dw (%2 & 0FFFFh)
   717 0000029A 0800                <2>  dw %1
   718 0000029C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   719 0000029E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   720                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   721 000002A0 0E83                <2>  dw (%2 & 0FFFFh)
   722 000002A2 0800                <2>  dw %1
   723 000002A4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   724 000002A6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   725                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   726 000002A8 0E83                <2>  dw (%2 & 0FFFFh)
   727 000002AA 0800                <2>  dw %1
   728 000002AC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   729 000002AE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   730                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   731 000002B0 0E83                <2>  dw (%2 & 0FFFFh)
   732 000002B2 0800                <2>  dw %1
   733 000002B4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   734 000002B6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   735                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   736 000002B8 0E83                <2>  dw (%2 & 0FFFFh)
   737 000002BA 0800                <2>  dw %1
   738 000002BC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   739 000002BE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   740                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   741 000002C0 0E83                <2>  dw (%2 & 0FFFFh)
   742 000002C2 0800                <2>  dw %1
   743 000002C4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   744 000002C6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   745                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   746 000002C8 0E83                <2>  dw (%2 & 0FFFFh)
   747 000002CA 0800                <2>  dw %1
   748 000002CC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   749 000002CE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   750                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   751 000002D0 0E83                <2>  dw (%2 & 0FFFFh)
   752 000002D2 0800                <2>  dw %1
   753 000002D4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   754 000002D6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   755                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   756 000002D8 0E83                <2>  dw (%2 & 0FFFFh)
   757 000002DA 0800                <2>  dw %1
   758 000002DC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   759 000002DE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   760                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   761 000002E0 0E83                <2>  dw (%2 & 0FFFFh)
   762 000002E2 0800                <2>  dw %1
   763 000002E4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   764 000002E6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   765                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   766 000002E8 0E83                <2>  dw (%2 & 0FFFFh)
   767 000002EA 0800                <2>  dw %1
   768 000002EC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   769 000002EE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   770                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   771 000002F0 0E83                <2>  dw (%2 & 0FFFFh)
   772 000002F2 0800                <2>  dw %1
   773 000002F4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   774 000002F6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   775                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   776 000002F8 0E83                <2>  dw (%2 & 0FFFFh)
   777 000002FA 0800                <2>  dw %1
   778 000002FC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   779 000002FE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   780                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   781 00000300 0E83                <2>  dw (%2 & 0FFFFh)
   782 00000302 0800                <2>  dw %1
   783 00000304 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   784 00000306 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   785                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   786 00000308 0E83                <2>  dw (%2 & 0FFFFh)
   787 0000030A 0800                <2>  dw %1
   788 0000030C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   789 0000030E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   790                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   791 00000310 0E83                <2>  dw (%2 & 0FFFFh)
   792 00000312 0800                <2>  dw %1
   793 00000314 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   794 00000316 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   795                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   796 00000318 0E83                <2>  dw (%2 & 0FFFFh)
   797 0000031A 0800                <2>  dw %1
   798 0000031C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   799 0000031E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   800                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   801 00000320 0E83                <2>  dw (%2 & 0FFFFh)
   802 00000322 0800                <2>  dw %1
   803 00000324 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   804 00000326 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   805                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   806 00000328 0E83                <2>  dw (%2 & 0FFFFh)
   807 0000032A 0800                <2>  dw %1
   808 0000032C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   809 0000032E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   810                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   811 00000330 0E83                <2>  dw (%2 & 0FFFFh)
   812 00000332 0800                <2>  dw %1
   813 00000334 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   814 00000336 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   815                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   816 00000338 0E83                <2>  dw (%2 & 0FFFFh)
   817 0000033A 0800                <2>  dw %1
   818 0000033C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   819 0000033E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   820                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   821 00000340 0E83                <2>  dw (%2 & 0FFFFh)
   822 00000342 0800                <2>  dw %1
   823 00000344 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   824 00000346 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   825                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   826 00000348 0E83                <2>  dw (%2 & 0FFFFh)
   827 0000034A 0800                <2>  dw %1
   828 0000034C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   829 0000034E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   830                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   831 00000350 0E83                <2>  dw (%2 & 0FFFFh)
   832 00000352 0800                <2>  dw %1
   833 00000354 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   834 00000356 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   835                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   836 00000358 0E83                <2>  dw (%2 & 0FFFFh)
   837 0000035A 0800                <2>  dw %1
   838 0000035C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   839 0000035E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   840                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   841 00000360 0E83                <2>  dw (%2 & 0FFFFh)
   842 00000362 0800                <2>  dw %1
   843 00000364 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   844 00000366 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   845                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   846 00000368 0E83                <2>  dw (%2 & 0FFFFh)
   847 0000036A 0800                <2>  dw %1
   848 0000036C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   849 0000036E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   850                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   851 00000370 0E83                <2>  dw (%2 & 0FFFFh)
   852 00000372 0800                <2>  dw %1
   853 00000374 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   854 00000376 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   855                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   856 00000378 0E83                <2>  dw (%2 & 0FFFFh)
   857 0000037A 0800                <2>  dw %1
   858 0000037C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   859 0000037E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   860                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   861 00000380 0E83                <2>  dw (%2 & 0FFFFh)
   862 00000382 0800                <2>  dw %1
   863 00000384 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   864 00000386 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   865                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   866 00000388 0E83                <2>  dw (%2 & 0FFFFh)
   867 0000038A 0800                <2>  dw %1
   868 0000038C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   869 0000038E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   870                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   871 00000390 0E83                <2>  dw (%2 & 0FFFFh)
   872 00000392 0800                <2>  dw %1
   873 00000394 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   874 00000396 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   875                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   876 00000398 0E83                <2>  dw (%2 & 0FFFFh)
   877 0000039A 0800                <2>  dw %1
   878 0000039C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   879 0000039E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   880                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   881 000003A0 0E83                <2>  dw (%2 & 0FFFFh)
   882 000003A2 0800                <2>  dw %1
   883 000003A4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   884 000003A6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   885                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   886 000003A8 0E83                <2>  dw (%2 & 0FFFFh)
   887 000003AA 0800                <2>  dw %1
   888 000003AC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   889 000003AE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   890                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   891 000003B0 0E83                <2>  dw (%2 & 0FFFFh)
   892 000003B2 0800                <2>  dw %1
   893 000003B4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   894 000003B6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   895                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   896 000003B8 0E83                <2>  dw (%2 & 0FFFFh)
   897 000003BA 0800                <2>  dw %1
   898 000003BC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   899 000003BE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   900                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   901 000003C0 0E83                <2>  dw (%2 & 0FFFFh)
   902 000003C2 0800                <2>  dw %1
   903 000003C4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   904 000003C6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   905                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   906 000003C8 0E83                <2>  dw (%2 & 0FFFFh)
   907 000003CA 0800                <2>  dw %1
   908 000003CC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   909 000003CE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   910                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   911 000003D0 0E83                <2>  dw (%2 & 0FFFFh)
   912 000003D2 0800                <2>  dw %1
   913 000003D4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   914 000003D6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   915                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   916 000003D8 0E83                <2>  dw (%2 & 0FFFFh)
   917 000003DA 0800                <2>  dw %1
   918 000003DC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   919 000003DE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   920                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   921 000003E0 0E83                <2>  dw (%2 & 0FFFFh)
   922 000003E2 0800                <2>  dw %1
   923 000003E4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   924 000003E6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   925                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   926 000003E8 0E83                <2>  dw (%2 & 0FFFFh)
   927 000003EA 0800                <2>  dw %1
   928 000003EC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   929 000003EE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   930                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   931 000003F0 0E83                <2>  dw (%2 & 0FFFFh)
   932 000003F2 0800                <2>  dw %1
   933 000003F4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   934 000003F6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   935                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   936 000003F8 0E83                <2>  dw (%2 & 0FFFFh)
   937 000003FA 0800                <2>  dw %1
   938 000003FC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   939 000003FE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   940                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   941 00000400 0E83                <2>  dw (%2 & 0FFFFh)
   942 00000402 0800                <2>  dw %1
   943 00000404 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   944 00000406 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   945                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   946 00000408 0E83                <2>  dw (%2 & 0FFFFh)
   947 0000040A 0800                <2>  dw %1
   948 0000040C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   949 0000040E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   950                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   951 00000410 0E83                <2>  dw (%2 & 0FFFFh)
   952 00000412 0800                <2>  dw %1
   953 00000414 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   954 00000416 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   955                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   956 00000418 0E83                <2>  dw (%2 & 0FFFFh)
   957 0000041A 0800                <2>  dw %1
   958 0000041C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   959 0000041E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   960                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   961 00000420 0E83                <2>  dw (%2 & 0FFFFh)
   962 00000422 0800                <2>  dw %1
   963 00000424 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   964 00000426 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   965                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   966 00000428 0E83                <2>  dw (%2 & 0FFFFh)
   967 0000042A 0800                <2>  dw %1
   968 0000042C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   969 0000042E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   970                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   971 00000430 0E83                <2>  dw (%2 & 0FFFFh)
   972 00000432 0800                <2>  dw %1
   973 00000434 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   974 00000436 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   975                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   976 00000438 0E83                <2>  dw (%2 & 0FFFFh)
   977 0000043A 0800                <2>  dw %1
   978 0000043C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   979 0000043E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   980                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   981 00000440 0E83                <2>  dw (%2 & 0FFFFh)
   982 00000442 0800                <2>  dw %1
   983 00000444 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   984 00000446 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   985                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   986 00000448 0E83                <2>  dw (%2 & 0FFFFh)
   987 0000044A 0800                <2>  dw %1
   988 0000044C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   989 0000044E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   990                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   991 00000450 0E83                <2>  dw (%2 & 0FFFFh)
   992 00000452 0800                <2>  dw %1
   993 00000454 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   994 00000456 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
   995                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
   996 00000458 0E83                <2>  dw (%2 & 0FFFFh)
   997 0000045A 0800                <2>  dw %1
   998 0000045C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
   999 0000045E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1000                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1001 00000460 0E83                <2>  dw (%2 & 0FFFFh)
  1002 00000462 0800                <2>  dw %1
  1003 00000464 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1004 00000466 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1005                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1006 00000468 0E83                <2>  dw (%2 & 0FFFFh)
  1007 0000046A 0800                <2>  dw %1
  1008 0000046C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1009 0000046E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1010                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1011 00000470 0E83                <2>  dw (%2 & 0FFFFh)
  1012 00000472 0800                <2>  dw %1
  1013 00000474 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1014 00000476 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1015                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1016 00000478 0E83                <2>  dw (%2 & 0FFFFh)
  1017 0000047A 0800                <2>  dw %1
  1018 0000047C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1019 0000047E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1020                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1021 00000480 0E83                <2>  dw (%2 & 0FFFFh)
  1022 00000482 0800                <2>  dw %1
  1023 00000484 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1024 00000486 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1025                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1026 00000488 0E83                <2>  dw (%2 & 0FFFFh)
  1027 0000048A 0800                <2>  dw %1
  1028 0000048C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1029 0000048E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1030                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1031 00000490 0E83                <2>  dw (%2 & 0FFFFh)
  1032 00000492 0800                <2>  dw %1
  1033 00000494 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1034 00000496 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1035                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1036 00000498 0E83                <2>  dw (%2 & 0FFFFh)
  1037 0000049A 0800                <2>  dw %1
  1038 0000049C 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1039 0000049E 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1040                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1041 000004A0 0E83                <2>  dw (%2 & 0FFFFh)
  1042 000004A2 0800                <2>  dw %1
  1043 000004A4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1044 000004A6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1045                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1046 000004A8 0E83                <2>  dw (%2 & 0FFFFh)
  1047 000004AA 0800                <2>  dw %1
  1048 000004AC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1049 000004AE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1050                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1051 000004B0 0E83                <2>  dw (%2 & 0FFFFh)
  1052 000004B2 0800                <2>  dw %1
  1053 000004B4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1054 000004B6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1055                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1056 000004B8 0E83                <2>  dw (%2 & 0FFFFh)
  1057 000004BA 0800                <2>  dw %1
  1058 000004BC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1059 000004BE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1060                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1061 000004C0 0E83                <2>  dw (%2 & 0FFFFh)
  1062 000004C2 0800                <2>  dw %1
  1063 000004C4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1064 000004C6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1065                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1066 000004C8 0E83                <2>  dw (%2 & 0FFFFh)
  1067 000004CA 0800                <2>  dw %1
  1068 000004CC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1069 000004CE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1070                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1071 000004D0 0E83                <2>  dw (%2 & 0FFFFh)
  1072 000004D2 0800                <2>  dw %1
  1073 000004D4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1074 000004D6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1075                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1076 000004D8 0E83                <2>  dw (%2 & 0FFFFh)
  1077 000004DA 0800                <2>  dw %1
  1078 000004DC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1079 000004DE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1080                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1081 000004E0 0E83                <2>  dw (%2 & 0FFFFh)
  1082 000004E2 0800                <2>  dw %1
  1083 000004E4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1084 000004E6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1085                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1086 000004E8 0E83                <2>  dw (%2 & 0FFFFh)
  1087 000004EA 0800                <2>  dw %1
  1088 000004EC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1089 000004EE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1090                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1091 000004F0 0E83                <2>  dw (%2 & 0FFFFh)
  1092 000004F2 0800                <2>  dw %1
  1093 000004F4 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1094 000004F6 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1095                              <1>  Gate 0x08, idtHandler, 0, DA_386IGate
  1096 000004F8 0E83                <2>  dw (%2 & 0FFFFh)
  1097 000004FA 0800                <2>  dw %1
  1098 000004FC 008E                <2>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1099 000004FE 0000                <2>  dw ((%2 >> 16) & 0FFFFh)
  1100                                  int80h: Gate   0x08,      userHandler, 0,       DA_386IGate
  1101                              <1> int80h: 
  1102 00000500 3583                <1>  dw (%2 & 0FFFFh)
  1103 00000502 0800                <1>  dw %1
  1104 00000504 008E                <1>  dw (%3 & 1Fh) | ((%4 << 8) & 0FF00h)
  1105 00000506 0000                <1>  dw ((%2 >> 16) & 0FFFFh)
  1106                                  
  1107                                      idtLen  equ  $-idt
  1108 00000508 0704                        idtPtr  dw   idtLen-1;æ®µç•Œé™
  1109 0000050A [00010000]                          dd   idt; base address
  1110                                  ;iiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii
  1111                                  
  1112                                  ; idt handler
  1113                                  ;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  1114                                      _idtHandler:
  1115                                      idtHandler equ  _idtHandler - $$ + INIT_ADDR
  1116                                          ;  void print_string_with_color(unsigned char * string, unsigned char color);
  1117 0000050E 6A0F                            push COLOR_White
  1118 00000510 68[52000000]                    push string0
  1119 00000515 E8(00000000)                    call print_string_with_color
  1120 0000051A 83C408                          add esp, 0x08
  1121                                  
  1122 0000051D CF                              iretd
  1123                                  
  1124                                      _clockHandler:
  1125                                      clockHandler equ  _clockHandler - $$ + INIT_ADDR
  1126                                          ;  void print_string_with_color(unsigned char * string, unsigned char color);
  1127 0000051E 6A04                            push COLOR_RED
  1128 00000520 68[6B000000]                    push string1
  1129 00000525 E8(00000000)                    call print_string_with_color
  1130 0000052A 83C408                          add esp, 0x08
  1131 0000052D FA                              cli
  1132 0000052E F4                              hlt
  1133 0000052F E8(00000000)                    call restart_clock
  1134                                  
  1135 00000534 CF                              iretd
  1136                                  
  1137                                      _userHandler:
  1138                                      userHandler equ  _userHandler - $$ + INIT_ADDR
  1139                                          ;  void print_string_with_color(unsigned char * string, unsigned char color);
  1140 00000535 6A02                            push COLOR_GREEN
  1141 00000537 68[8F000000]                    push string3
  1142 0000053C E8(00000000)                    call print_string_with_color
  1143 00000541 83C408                          add esp, 0x08
  1144                                  
  1145 00000544 CF                              iretd
  1146                                      _test0Handler:
  1147                                      test0Handler equ  _test0Handler - $$ + INIT_ADDR
  1148                                          ;  void print_string_with_color(unsigned char * string, unsigned char color);
  1149 00000545 6A03                            push COLOR_Cyan
  1150 00000547 68[D0000000]                    push string6
  1151 0000054C E8(00000000)                    call print_string_with_color
  1152 00000551 83C408                          add esp, 0x08
  1153                                  
  1154 00000554 CF                              iretd
  1155                                      _test1Handler:
  1156                                      test1Handler equ  _test1Handler - $$ + INIT_ADDR
  1157                                          ;  void print_string_with_color(unsigned char * string, unsigned char color);
  1158 00000555 6A03                            push COLOR_Cyan
  1159 00000557 68[BA000000]                    push string5
  1160 0000055C E8(00000000)                    call print_string_with_color
  1161 00000561 83C408                          add esp, 0x08
  1162                                  
  1163 00000564 CF                              iretd
  1164                                  ;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<   
  1165                                  
  1166                                  ; new GDT ----------------------------------------------------------------------------------------
  1167                                  ;                         æ®µåŸºå€,      æ®µç•Œé™,   å±æ€§                                 -
  1168                                  GDT:       Descriptor          0,           0,   0                             ; ç©ºæè¿°ç¬¦   -
  1169                              <1> GDT: 
  1170 00000565 0000                <1>  dw %2 & 0FFFFh
  1171 00000567 0000                <1>  dw %1 & 0FFFFh
  1172 00000569 00                  <1>  db (%1 >> 16) & 0FFh
  1173 0000056A 0000                <1>  dw ((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)
  1174 0000056C 00                  <1>  db (%1 >> 24) & 0FFh
  1175                                  FLAT_C:    Descriptor          0,     0fffffh,   DA_CR  | DA_32 | DA_LIMIT_4K ;|DA_DRW ; 0 ~ 4G     -
  1176                              <1> FLAT_C: 
  1177 0000056D FFFF                <1>  dw %2 & 0FFFFh
  1178 0000056F 0000                <1>  dw %1 & 0FFFFh
  1179 00000571 00                  <1>  db (%1 >> 16) & 0FFh
  1180 00000572 9ACF                <1>  dw ((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)
  1181 00000574 00                  <1>  db (%1 >> 24) & 0FFh
  1182                                  FLAT_RW:   Descriptor          0,     0fffffh,   DA_DRW | DA_32 | DA_LIMIT_4K  ; 0 ~ 4G     -
  1183                              <1> FLAT_RW: 
  1184 00000575 FFFF                <1>  dw %2 & 0FFFFh
  1185 00000577 0000                <1>  dw %1 & 0FFFFh
  1186 00000579 00                  <1>  db (%1 >> 16) & 0FFh
  1187 0000057A 92CF                <1>  dw ((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)
  1188 0000057C 00                  <1>  db (%1 >> 24) & 0FFh
  1189                                  VIDEO:     Descriptor    0B8000h,      0ffffh,   DA_DRW ;| DA_DPL3              ; æ˜¾å­˜é¦–åœ°å€ -
  1190                              <1> VIDEO: 
  1191 0000057D FFFF                <1>  dw %2 & 0FFFFh
  1192 0000057F 0080                <1>  dw %1 & 0FFFFh
  1193 00000581 0B                  <1>  db (%1 >> 16) & 0FFh
  1194 00000582 9200                <1>  dw ((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)
  1195 00000584 00                  <1>  db (%1 >> 24) & 0FFh
  1196                                  DESC_TSS:  Descriptor TSSADDRESS,    TSSLen-1,   DA_386TSS
  1197                              <1> DESC_TSS: 
  1198 00000585 6700                <1>  dw %2 & 0FFFFh
  1199 00000587 A383                <1>  dw %1 & 0FFFFh
  1200 00000589 00                  <1>  db (%1 >> 16) & 0FFh
  1201 0000058A 8900                <1>  dw ((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)
  1202 0000058C 00                  <1>  db (%1 >> 24) & 0FFh
  1203                                  DESC_TSS1: Descriptor TSS1ADDRESS,    TSS1Len-1,   DA_386TSS
  1204                              <1> DESC_TSS1: 
  1205 0000058D 6700                <1>  dw %2 & 0FFFFh
  1206 0000058F 0B84                <1>  dw %1 & 0FFFFh
  1207 00000591 00                  <1>  db (%1 >> 16) & 0FFh
  1208 00000592 8900                <1>  dw ((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)
  1209 00000594 00                  <1>  db (%1 >> 24) & 0FFh
  1210                                  LDT_IN_GDT:Descriptor LDTADDRESS,    LDTLen-1,   DA_LDT    ; LDT
  1211                              <1> LDT_IN_GDT:
  1212 00000595 0700                <1>  dw %2 & 0FFFFh
  1213 00000597 7384                <1>  dw %1 & 0FFFFh
  1214 00000599 00                  <1>  db (%1 >> 16) & 0FFh
  1215 0000059A 8200                <1>  dw ((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)
  1216 0000059C 00                  <1>  db (%1 >> 24) & 0FFh
  1217                                  ; GDT END-------------------------------------------------------------------------------------
  1218                                  
  1219                                  GdtLen  equ $ - GDT
  1220 0000059D 3700                    GdtPtr  dw GdtLen - 1                          ; æ®µç•Œé™
  1221 0000059F [65050000]                      dd GDT;+ BaseOfLoaderPhyAddr           ; åŸºåœ°å€
  1222                                  
  1223                                  
  1224                                  ; GDT é€‰æ‹©å­ ---------------------------------------------
  1225                                  SelectorFlatC     equ   FLAT_C   - GDT              ;1*8
  1226                                  SelectorFlatRW    equ   FLAT_RW  - GDT              ;2*8
  1227                                  SelectorVideo     equ   VIDEO    - GDT ;+ SA_RPL3   ;3*8
  1228                                  SelectorTSS       equ  DESC_TSS  - GDT              ;4*8
  1229                                  SelectorTSS1      equ  DESC_TSS1 - GDT              ;5*8
  1230                                  SelectorLDT       equ LDT_IN_GDT - GDT              ;6*8
  1231                                  ; GDT é€‰æ‹©å­ end------------------------------------------
  1232                                  
  1233                                  ;[BITS   32]
  1234                                  TSS:
  1235                                  TSSADDRESS equ $-$$+INIT_ADDR
  1236 000005A3 0000                        DW  0           ; Previous Task Link
  1237 000005A5 0000                        DW  0           ; Reserved 
  1238 000005A7 00000000                    DD  0           ; ESP0
  1239 000005AB 0000                        DW  0           ; SS0
  1240 000005AD 0000                        DW  0           ; Reserved 
  1241 000005AF 00000000                    DD  0           ; ESP1
  1242 000005B3 0000                        DW  0           ; SS1
  1243 000005B5 0000                        DW  0           ; Reserved 
  1244 000005B7 00000000                    DD  0           ; ESP2
  1245 000005BB 0000                        DW  0           ; SS2
  1246 000005BD 0000                        DW  0           ; Reserved 
  1247 000005BF 00000000                    DD  0           ;CR3 (PDBR)
  1248 000005C3 00000000                    DD  0           ;EIP
  1249 000005C7 00000000                    DD  0           ;EFLAGS
  1250 000005CB 00000000                    DD  0           ;EAX
  1251 000005CF 00000000                    DD  0           ;ECX
  1252 000005D3 00000000                    DD  0           ;EDX
  1253 000005D7 00000000                    DD  0           ;EBX
  1254 000005DB 00000000                    DD  0           ;ESP
  1255 000005DF 00000000                    DD  0           ;EBP
  1256 000005E3 00000000                    DD  0           ;ESI
  1257 000005E7 00000000                    DD  0           ;EDI
  1258 000005EB 0000                        DW  0           ; ES
  1259 000005ED 0000                        DW  0           ; Reserved 
  1260 000005EF 0000                        DW  0           ; CS
  1261 000005F1 0000                        DW  0           ; Reserved 
  1262 000005F3 0000                        DW  0           ; SS
  1263 000005F5 0000                        DW  0           ; Reserved 
  1264 000005F7 0000                        DW  0           ; DS
  1265 000005F9 0000                        DW  0           ; Reserved 
  1266 000005FB 0000                        DW  0           ; FS
  1267 000005FD 0000                        DW  0           ; Reserved 
  1268 000005FF 0000                        DW  0           ; GS
  1269 00000601 0000                        DW  0           ; Reserved 
  1270 00000603 0000                        DW  0           ; LDT Segment Selector
  1271 00000605 0000                        DW  0           ; Reserved 
  1272 00000607 0000                        DW  0           ; Reserved
  1273 00000609 0040                        DW  0x4000           ; I/O Map Base Address 
  1274                                      
  1275                                  TSSLen      equ $ - TSS     ;must have a value equal to or greater than 103
  1276                                  
  1277                                  TSS1:
  1278                                  TSS1ADDRESS equ $-$$+INIT_ADDR
  1279 0000060B 0000                        DW  0           ; Previous Task Link
  1280 0000060D 0000                        DW  0           ; Reserved 
  1281 0000060F 00000000                    DD  0           ; ESP0
  1282 00000613 0000                        DW  0           ; SS0
  1283 00000615 0000                        DW  0           ; Reserved 
  1284 00000617 00000000                    DD  0           ; ESP1
  1285 0000061B 0000                        DW  0           ; SS1
  1286 0000061D 0000                        DW  0           ; Reserved 
  1287 0000061F 00000000                    DD  0           ; ESP2
  1288 00000623 0000                        DW  0           ; SS2
  1289 00000625 0000                        DW  0           ; Reserved 
  1290 00000627 00000000                    DD  0           ;CR3 (PDBR)
  1291 0000062B 7B840000                    DD  TASK0ADDRESS           ;EIP
  1292 0000062F 00000000                    DD  0           ;EFLAGS
  1293 00000633 00000000                    DD  0           ;EAX
  1294 00000637 00000000                    DD  0           ;ECX
  1295 0000063B 00000000                    DD  0           ;EDX
  1296 0000063F 00000000                    DD  0           ;EBX
  1297 00000643 00000000                    DD  0           ;ESP
  1298 00000647 00000000                    DD  0           ;EBP
  1299 0000064B 00000000                    DD  0           ;ESI
  1300 0000064F 00000000                    DD  0           ;EDI
  1301 00000653 1000                        DW  SelectorFlatRW           ; ES
  1302 00000655 0000                        DW  0           ; Reserved 
  1303 00000657 0800                        DW  SelectorFlatC           ; CS
  1304 00000659 0000                        DW  0           ; Reserved 
  1305 0000065B 1000                        DW  SelectorFlatRW           ; SS
  1306 0000065D 0000                        DW  0           ; Reserved 
  1307 0000065F 1000                        DW  SelectorFlatRW           ; DS
  1308 00000661 0000                        DW  0           ; Reserved 
  1309 00000663 1000                        DW  SelectorFlatRW           ; FS
  1310 00000665 0000                        DW  0           ; Reserved 
  1311 00000667 1800                        DW  SelectorVideo           ; GS
  1312 00000669 0000                        DW  0           ; Reserved 
  1313 0000066B 0000                        DW  0           ; LDT Segment Selector
  1314 0000066D 0000                        DW  0           ; Reserved 
  1315 0000066F 0000                        DW  0           ; Reserved
  1316 00000671 0040                        DW  0x4000           ; I/O Map Base Address 
  1317                                      
  1318                                  TSS1Len      equ $ - TSS1     ;must have a value equal to or greater than 103
  1319                                  
  1320                                  ;ALIGN   32
  1321                                  LDT:
  1322                                  LDTADDRESS equ $-$$+INIT_ADDR
  1323                                  ;                            æ®µåŸºå€       æ®µç•Œé™      å±æ€§
  1324                                  ;LDT_P0: Descriptor TASK0ADDRESS, TASK0Len - 1, DA_C + DA_32 ; Code, 32 ä½
  1325                                  LDT_P0_RW: Descriptor TASK0_RWADDRESS, TASK0_RWLen - 1, DA_DRW  ; Code, 32 ä½
  1326                              <1> LDT_P0_RW: 
  1327 00000673 FF03                <1>  dw %2 & 0FFFFh
  1328 00000675 8884                <1>  dw %1 & 0FFFFh
  1329 00000677 00                  <1>  db (%1 >> 16) & 0FFh
  1330 00000678 9200                <1>  dw ((%2 >> 8) & 0F00h) | (%3 & 0F0FFh)
  1331 0000067A 00                  <1>  db (%1 >> 24) & 0FFh
  1332                                  ;LDT_P0: Descriptor 0,     0fffffh,   DA_CR  | DA_32 | DA_LIMIT_4K
  1333                                  
  1334                                  LDTLen      equ $ - LDT
  1335                                  ; LDT é€‰æ‹©å­
  1336                                  ;SelectorLDTP0    equ LDT_P0    - LDT + SA_TIL
  1337                                  SelectorLDTP0_RW    equ LDT_P0_RW    - LDT + SA_TIL
  1338                                  ; END of [SECTION .ldt]
  1339                                  
  1340                                  TASK0:
  1341                                  TASK0ADDRESS equ $-$$+INIT_ADDR
  1342                                      ;print_a:
  1343 0000067B B078                            mov al, 'x'    
  1344 0000067D B40F                            mov ah, 0x0f   ;åœŸçº¢è‰²
  1345 0000067F 31FF                            xor edi, edi
  1346 00000681 65668907                        mov [gs:edi], ax        
  1347                                          ;ret
  1348                                          ;call task0
  1349 00000685 F4                          hlt
  1350 00000686 EBFE                        jmp $
  1351                                  TASK0Len equ $ - TASK0
  1352                                  
  1353                                  TASK0_RW:
  1354                                  TASK0_RWADDRESS equ $-$$+INIT_ADDR
  1355 00000688 00<rept>                    times 1024 db 0
  1356                                  TASK0_RWLen equ $ - TASK0_RW
  1357                                  ; END 
